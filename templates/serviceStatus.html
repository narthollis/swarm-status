<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Service Status</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
          integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css"
          integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp" crossorigin="anonymous">
    <link rel="stylesheet" href="static/cover.css"/>
</head>
<body class="text-center">
<div class="cover-container d-flex h-100 p-3 mx-auto flex-column">
    <header class="masthead mb-auto">
        <div class="inner">
            <h3 class="masthead-brand">Status</h3>
            <nav class="nav nav-masthead justify-content-center">
                <a class="nav-link active" href="./">Services</a>
                <a class="nav-link" href="./metrics">Metrics</a>
            </nav>
        </div>
    </header>
    <main role="main" class="inner cover table-responsive">
        <div class="alert alert-{{ .OverallStatus.ClassName }}" role="alert">
            <h4 class="alert-heading">{{ .OverallStatus.Overview }}</h4>
        </div>
        <table class="table table-dark table-striped table-sm">
            <caption>Last Updated: {{ .Timestamp }}</caption>
            <thead class="thead-light">
            <tr>
                <th>Name</th>
                <th>Nodes</th>
                <th>Status</th>
            </tr>
            </thead>
        {{range $groupName, $group := .Groups}}
            <thead class="thead-dark" data-for="{{ $groupName }}" style="cursor: pointer;">
            <tr>
                <th colspan="2" style="text-align: left; padding-left: 2rem;">{{ $groupName }}</th>
                <th class="bg-{{ $group.Status.ClassName }}">
                    {{ $group.Status }} <i class="fas {{ $group.Status.Icon }} float-right"></i>
                </th>
            </tr>
            </thead>
            <tbody id="{{ $groupName }}" style="display: {{if eq $group.Status 0}}none{{else}}table-row-group{{end}};">
            {{ range $group.Services }}
            <tr>
                <td style="text-align: left;">{{ .Name }}</td>
                <td>{{ .Running }} / {{ .Replicas }}</td>
                <td class="bg-{{ .Status.ClassName }}">
                    {{ .Status }} <i class="fas {{ .Status.Icon }} float-right"></i>
                </td>
            </tr>
            {{end}}
            </tbody>
        {{end}}
        </table>
    </main>
    <footer class="mastfoot mt-auto">
        <div class="inner">
            <p>Cover template for <a href="https://getbootstrap.com/">Bootstrap</a>, by <a
                    href="https://twitter.com/mdo">@mdo</a>.</p>
        </div>
    </footer>
    <script type="application/javascript">
        "use strict";

        setTimeout(function () {
            window.location.reload();
        }, 30000)

        document.querySelectorAll('thead[data-for]').forEach((thead) => {
            thead.addEventListener('click', (evt) => {
                const forId = evt.currentTarget.dataset['for'];
                if (forId != null) {
                    const tbody = document.getElementById(forId);
                    if (tbody.style.display == 'none') {
                        tbody.style.display = 'table-row-group'
                    } else {
                        tbody.style.display = 'none'
                    }
                }
            })
        });
    </script>
</div>
</body>
</html>
